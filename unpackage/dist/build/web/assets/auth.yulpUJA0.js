import{j as o,b as n,K as t,B as e,s,r as c}from"./index-C85BGToL.js";let r=!1;function u(){try{const n=o("crm_token")||o("token")||"";return console.log("[auth/getToken] =>",n?"有 token":"无 token"),n}catch(n){return console.warn("[auth/getToken] 读取异常",n),""}}function a(o){o&&(console.log("[auth/setToken] 保存 token"),n("crm_token",o))}function l(){console.log("[auth/clearAuth] 清空登录信息");try{t("crm_token"),t("crm_user_info")}catch(o){}}function i(o){console.log("[auth/setUserInfo] 保存用户信息"),n("crm_user_info",o||{})}function g(){try{return o("crm_user_info")||{}}catch(n){return{}}}function h(o){var n;if(r)console.log("[auth/goLogin] 已在跳转中，忽略");else{try{const o=e(),t=(null==(n=o[o.length-1])?void 0:n.route)||"";if(console.log("[auth/goLogin] 当前路由 =",t),"pages/login/login"===t)return void console.log("[auth/goLogin] 已在登录页，直接返回")}catch(t){}r=!0,o&&s({title:o,icon:"none",duration:1500}),l(),setTimeout((()=>{console.log("[auth/goLogin] reLaunch 到登录页"),c({url:"/pages/login/login"}),setTimeout((()=>{r=!1}),500)}),o?1200:0)}}function f(){const o=u();return console.log("[auth/ensureLogin] token 是否存在 =",!!o),!!o||(console.log("[auth/ensureLogin] 未登录，准备跳登录"),h("请先登录"),!1)}export{i as a,h as b,l as c,u as d,f as e,g,a as s};
